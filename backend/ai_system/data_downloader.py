#!/usr/bin/env python3
"""
–ú–æ—â–Ω—ã–π –∑–∞–≥—Ä—É–∑—á–∏–∫ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ —Å–æ—Ç–µ–Ω —Ç—ã—Å—è—á –æ–±—Ä–∞–∑—Ü–æ–≤
"""

import json
import csv
import os
import random
import logging
import time
from datetime import datetime
from typing import List, Dict, Optional, Any, Tuple
from itertools import combinations, product
import numpy as np

logging.basicConfig(level=logging.INFO)
logger = logging.getLogger(__name__)

class MassiveMedicalDataGenerator:
    """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –æ–≥—Ä–æ–º–Ω—ã—Ö –æ–±—ä–µ–º–æ–≤ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö —Å –≥–∞—Ä–∞–Ω—Ç–∏–µ–π —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏"""
    
    def __init__(self, output_dir: str = "medical_data"):
        self.output_dir = output_dir
        os.makedirs(output_dir, exist_ok=True)
        
        # –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
        self.used_combinations = set()
        self.symptom_counters = {}
        self.disease_counters = {}
        
        # –û–≥—Ä–æ–º–Ω–∞—è –±–∞–∑–∞ —Å–∏–º–ø—Ç–æ–º–æ–≤ –ø–æ —Å–∏—Å—Ç–µ–º–∞–º –æ—Ä–≥–∞–Ω–∏–∑–º–∞
        self.symptoms_database = {
            'respiratory': [
                '–∫–∞—à–µ–ª—å', '–æ–¥—ã—à–∫–∞', '–±–æ–ª—å –≤ –≥—Ä—É–¥–∏', '—Ö—Ä–∏–ø—ã', '–º–æ–∫—Ä–æ—Ç–∞', '–∫—Ä–æ–≤–æ—Ö–∞—Ä–∫–∞–Ω—å–µ',
                '–±–æ–ª—å –ø—Ä–∏ –¥—ã—Ö–∞–Ω–∏–∏', '—É–¥—É—à—å–µ', '—Å–≤–∏—Å—Ç—è—â–µ–µ –¥—ã—Ö–∞–Ω–∏–µ', '—Å—É—Ö–æ–π –∫–∞—à–µ–ª—å',
                '–≤–ª–∞–∂–Ω—ã–π –∫–∞—à–µ–ª—å', '–Ω–æ—á–Ω–æ–π –∫–∞—à–µ–ª—å', '–±–æ–ª—å –≤ –ª–µ–≥–∫–∏—Ö', '–∑–∞—Ç—Ä—É–¥–Ω–µ–Ω–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ',
                '—É—á–∞—â–µ–Ω–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ', '–ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–Ω–æ–µ –¥—ã—Ö–∞–Ω–∏–µ', '–∞–ø–Ω–æ—ç', '—Ü–∏–∞–Ω–æ–∑',
                '–±–æ–ª—å –≤ —Ä–µ–±—Ä–∞—Ö', '–±–æ–ª—å –ø—Ä–∏ –∫–∞—à–ª–µ', '–ø–µ—Ä—à–µ–Ω–∏–µ –≤ –≥–æ—Ä–ª–µ', '–æ—Å–∏–ø–ª–æ—Å—Ç—å –≥–æ–ª–æ—Å–∞'
            ],
            'cardiovascular': [
                '–±–æ–ª—å –≤ –≥—Ä—É–¥–∏', '–æ–¥—ã—à–∫–∞', '—É—á–∞—â–µ–Ω–Ω–æ–µ —Å–µ—Ä–¥—Ü–µ–±–∏–µ–Ω–∏–µ', '–æ—Ç–µ–∫–∏', '–≥–æ–ª–æ–≤–æ–∫—Ä—É–∂–µ–Ω–∏–µ',
                '–æ–±–º–æ—Ä–æ–∫–∏', '–±–æ–ª—å –≤ —Å–µ—Ä–¥—Ü–µ', '–∞—Ä–∏—Ç–º–∏—è', '—Ç–∞—Ö–∏–∫–∞—Ä–¥–∏—è', '–±—Ä–∞–¥–∏–∫–∞—Ä–¥–∏—è',
                '–±–æ–ª—å –≤ –ª–µ–≤–æ–π —Ä—É–∫–µ', '–±–æ–ª—å –≤ —à–µ–µ', '–±–æ–ª—å –≤ —á–µ–ª—é—Å—Ç–∏', '—Ö–æ–ª–æ–¥–Ω—ã–π –ø–æ—Ç',
                '–±–ª–µ–¥–Ω–æ—Å—Ç—å', '—Å–∏–Ω—é—à–Ω–æ—Å—Ç—å', '—É—Å—Ç–∞–ª–æ—Å—Ç—å', '—Å–ª–∞–±–æ—Å—Ç—å', '—Ç–æ—à–Ω–æ—Ç–∞ –ø—Ä–∏ –Ω–∞–≥—Ä—É–∑–∫–µ',
                '–±–æ–ª—å –º–µ–∂–¥—É –ª–æ–ø–∞—Ç–∫–∞–º–∏', '–æ—Ç–µ–∫–∏ –Ω–æ–≥', '–æ—Ç–µ–∫–∏ —Ä—É–∫', '–Ω–∞–±—É—Ö–∞–Ω–∏–µ –≤–µ–Ω',
                '–ø—É–ª—å—Å–∞—Ü–∏—è –≤ –≥–æ–ª–æ–≤–µ', '—à—É–º –≤ —É—à–∞—Ö', '–º—É—à–∫–∏ –ø–µ—Ä–µ–¥ –≥–ª–∞–∑–∞–º–∏'
            ],
            'gastrointestinal': [
                '–±–æ–ª—å –≤ –∂–∏–≤–æ—Ç–µ', '—Ç–æ—à–Ω–æ—Ç–∞', '—Ä–≤–æ—Ç–∞', '–¥–∏–∞—Ä–µ—è', '–∑–∞–ø–æ—Ä', '–∏–∑–∂–æ–≥–∞',
                '–æ—Ç—Ä—ã–∂–∫–∞', '–≤–∑–¥—É—Ç–∏–µ –∂–∏–≤–æ—Ç–∞', '–±–æ–ª—å –≤ –∂–µ–ª—É–¥–∫–µ', '–±–æ–ª—å –≤ –∫–∏—à–µ—á–Ω–∏–∫–µ',
                '–∫—Ä–æ–≤—å –≤ —Å—Ç—É–ª–µ', '—á–µ—Ä–Ω—ã–π —Å—Ç—É–ª', '—Å–ª–∏–∑—å –≤ —Å—Ç—É–ª–µ', '–∂–∏–¥–∫–∏–π —Å—Ç—É–ª',
                '—á–∞—Å—Ç—ã–π —Å—Ç—É–ª', '–±–æ–ª—å –ø—Ä–∏ –≥–ª–æ—Ç–∞–Ω–∏–∏', '–∑–∞—Ç—Ä—É–¥–Ω–µ–Ω–Ω–æ–µ –≥–ª–æ—Ç–∞–Ω–∏–µ',
                '–±–æ–ª—å –≤ –ø–æ–¥—Ä–µ–±–µ—Ä—å–µ', '–∂–µ–ª—Ç—É—Ö–∞', '–≥–æ—Ä–µ—á—å –≤–æ —Ä—Ç—É', '—Å—É—Ö–æ—Å—Ç—å –≤–æ —Ä—Ç—É',
                '–ø–æ–≤—ã—à–µ–Ω–Ω–æ–µ —Å–ª—é–Ω–æ–æ—Ç–¥–µ–ª–µ–Ω–∏–µ', '–ø–æ—Ç–µ—Ä—è –∞–ø–ø–µ—Ç–∏—Ç–∞', '–±—ã—Å—Ç—Ä–æ–µ –Ω–∞—Å—ã—â–µ–Ω–∏–µ',
                '–±–æ–ª—å –ø–æ—Å–ª–µ –µ–¥—ã', '–≥–æ–ª–æ–¥–Ω—ã–µ –±–æ–ª–∏', '–Ω–æ—á–Ω—ã–µ –±–æ–ª–∏', '–∫–æ–ª–∏–∫–æ–æ–±—Ä–∞–∑–Ω—ã–µ –±–æ–ª–∏'
            ],
            'neurological': [
                '–≥–æ–ª–æ–≤–Ω–∞—è –±–æ–ª—å', '–≥–æ–ª–æ–≤–æ–∫—Ä—É–∂–µ–Ω–∏–µ', '—Ç–æ—à–Ω–æ—Ç–∞', '—Ä–≤–æ—Ç–∞', '—Å–ª–∞–±–æ—Å—Ç—å',
                '–æ–Ω–µ–º–µ–Ω–∏–µ', '–ø–æ–∫–∞–ª—ã–≤–∞–Ω–∏–µ', '—Å—É–¥–æ—Ä–æ–≥–∏', '–¥—Ä–æ–∂—å', '–Ω–∞—Ä—É—à–µ–Ω–∏–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏–∏',
                '–Ω–∞—Ä—É—à–µ–Ω–∏–µ —Ä–µ—á–∏', '–Ω–∞—Ä—É—à–µ–Ω–∏–µ –∑—Ä–µ–Ω–∏—è', '–Ω–∞—Ä—É—à–µ–Ω–∏–µ —Å–ª—É—Ö–∞', '–ø–æ—Ç–µ—Ä—è —Å–æ–∑–Ω–∞–Ω–∏—è',
                '—Å–ø—É—Ç–∞–Ω–Ω–æ—Å—Ç—å —Å–æ–∑–Ω–∞–Ω–∏—è', '–∑–∞–±—ã–≤—á–∏–≤–æ—Å—Ç—å', '–Ω–∞—Ä—É—à–µ–Ω–∏–µ —Å–Ω–∞', '–±–µ—Å—Å–æ–Ω–Ω–∏—Ü–∞',
                '—Å–æ–Ω–ª–∏–≤–æ—Å—Ç—å', '—Ä–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–¥–µ–ø—Ä–µ—Å—Å–∏—è', '—Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å',
                '–ø–∞–Ω–∏—á–µ—Å–∫–∏–µ –∞—Ç–∞–∫–∏', '–º–∏–≥—Ä–µ–Ω—å', '–Ω–∞–ø—Ä—è–∂–µ–Ω–∏–µ –≤ –≥–æ–ª–æ–≤–µ', '–ø—É–ª—å—Å–∏—Ä—É—é—â–∞—è –±–æ–ª—å',
                '—Å–≤–µ—Ç–æ–±–æ—è–∑–Ω—å', '–∑–≤—É–∫–æ–±–æ—è–∑–Ω—å', '–∞—É—Ä–∞', '–ø–∞—Ä–µ—Å—Ç–µ–∑–∏–∏', '–ø–∞—Ä–∞–ª–∏—á'
            ],
            'musculoskeletal': [
                '–±–æ–ª—å –≤ –º—ã—à—Ü–∞—Ö', '–±–æ–ª—å –≤ —Å—É—Å—Ç–∞–≤–∞—Ö', '—Å–∫–æ–≤–∞–Ω–Ω–æ—Å—Ç—å', '–æ—Ç–µ–∫ —Å—É—Å—Ç–∞–≤–æ–≤',
                '–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –¥–≤–∏–∂–µ–Ω–∏–π', '—Ö—Ä—É—Å—Ç –≤ —Å—É—Å—Ç–∞–≤–∞—Ö', '–¥–µ—Ñ–æ—Ä–º–∞—Ü–∏—è —Å—É—Å—Ç–∞–≤–æ–≤',
                '–º—ã—à–µ—á–Ω–∞—è —Å–ª–∞–±–æ—Å—Ç—å', '–º—ã—à–µ—á–Ω—ã–µ —Å–ø–∞–∑–º—ã', '–±–æ–ª—å –≤ —Å–ø–∏–Ω–µ', '–±–æ–ª—å –≤ —à–µ–µ',
                '–±–æ–ª—å –≤ –ø–ª–µ—á–∞—Ö', '–±–æ–ª—å –≤ –∫–æ–ª–µ–Ω—è—Ö', '–±–æ–ª—å –≤ –ª–æ–∫—Ç—è—Ö', '–±–æ–ª—å –≤ –∑–∞–ø—è—Å—Ç—å—è—Ö',
                '–±–æ–ª—å –≤ –ø–∞–ª—å—Ü–∞—Ö', '—É—Ç—Ä–µ–Ω–Ω—è—è —Å–∫–æ–≤–∞–Ω–Ω–æ—Å—Ç—å', '–±–æ–ª—å –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏',
                '–±–æ–ª—å –≤ –ø–æ–∫–æ–µ', '–≤–æ—Å–ø–∞–ª–µ–Ω–∏–µ —Å—É—Å—Ç–∞–≤–æ–≤', '–ø–æ–∫—Ä–∞—Å–Ω–µ–Ω–∏–µ —Å—É—Å—Ç–∞–≤–æ–≤',
                '–ø–æ–≤—ã—à–µ–Ω–∏–µ —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—ã –Ω–∞–¥ —Å—É—Å—Ç–∞–≤–æ–º', '—â–µ–ª—á–∫–∏ –≤ —Å—É—Å—Ç–∞–≤–∞—Ö'
            ],
            'dermatological': [
                '–∑—É–¥', '—Å—ã–ø—å', '–ø–æ–∫—Ä–∞—Å–Ω–µ–Ω–∏–µ', '—à–µ–ª—É—à–µ–Ω–∏–µ', '–æ—Ç–µ–∫ –∫–æ–∂–∏', '–≤–æ–ª–¥—ã—Ä–∏',
                '–ø—É–∑—ã—Ä–∏', '—è–∑–≤—ã', '—Ç—Ä–µ—â–∏–Ω—ã', '—Å—É—Ö–æ—Å—Ç—å –∫–æ–∂–∏', '–∂–∏—Ä–Ω–æ—Å—Ç—å –∫–æ–∂–∏',
                '–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–≤–µ—Ç–∞ –∫–æ–∂–∏', '–ø—è—Ç–Ω–∞ –Ω–∞ –∫–æ–∂–µ', '—Ä–æ–¥–∏–Ω–∫–∏', '–±–æ—Ä–æ–¥–∞–≤–∫–∏',
                '–≤—ã–ø–∞–¥–µ–Ω–∏–µ –≤–æ–ª–æ—Å', '–ª–æ–º–∫–æ—Å—Ç—å –Ω–æ–≥—Ç–µ–π', '–∏–∑–º–µ–Ω–µ–Ω–∏–µ –Ω–æ–≥—Ç–µ–π',
                '–ø–æ—Ç–ª–∏–≤–æ—Å—Ç—å', '–Ω–µ–ø—Ä–∏—è—Ç–Ω—ã–π –∑–∞–ø–∞—Ö', '–∂–∂–µ–Ω–∏–µ –∫–æ–∂–∏', '–±–æ–ª—å –≤ –∫–æ–∂–µ',
                '–∫—Ä–æ–≤–æ—Ç–æ—á–∏–≤–æ—Å—Ç—å', '–∫–æ—Ä–∫–∏', '—á–µ—à—É–π–∫–∏', '—É–∑–µ–ª–∫–∏', '–æ–ø—É—Ö–æ–ª–∏ –∫–æ–∂–∏'
            ],
            'endocrine': [
                '—É—Å—Ç–∞–ª–æ—Å—Ç—å', '–∏–∑–º–µ–Ω–µ–Ω–∏–µ –≤–µ—Å–∞', '–ø–æ–≤—ã—à–µ–Ω–Ω–∞—è –∂–∞–∂–¥–∞', '—á–∞—Å—Ç–æ–µ –º–æ—á–µ–∏—Å–ø—É—Å–∫–∞–Ω–∏–µ',
                '–ø–æ–≤—ã—à–µ–Ω–Ω—ã–π –∞–ø–ø–µ—Ç–∏—Ç', '—Å–Ω–∏–∂–µ–Ω–∏–µ –∞–ø–ø–µ—Ç–∏—Ç–∞', '–ø–æ—Ç–ª–∏–≤–æ—Å—Ç—å', '—Å—É—Ö–æ—Å—Ç—å –∫–æ–∂–∏',
                '–≤—ã–ø–∞–¥–µ–Ω–∏–µ –≤–æ–ª–æ—Å', '–∏–∑–º–µ–Ω–µ–Ω–∏–µ –≥–æ–ª–æ—Å–∞', '–Ω–∞—Ä—É—à–µ–Ω–∏–µ –º–µ–Ω—Å—Ç—Ä—É–∞–ª—å–Ω–æ–≥–æ —Ü–∏–∫–ª–∞',
                '—Å–Ω–∏–∂–µ–Ω–∏–µ –ª–∏–±–∏–¥–æ', '–∏–º–ø–æ—Ç–µ–Ω—Ü–∏—è', '–±–µ—Å–ø–ª–æ–¥–∏–µ', '—É–≤–µ–ª–∏—á–µ–Ω–∏–µ —â–∏—Ç–æ–≤–∏–¥–Ω–æ–π –∂–µ–ª–µ–∑—ã',
                '–¥—Ä–æ–∂—å –≤ —Ä—É–∫–∞—Ö', '—Å–µ—Ä–¥—Ü–µ–±–∏–µ–Ω–∏–µ', '–Ω–µ—Ä–≤–æ–∑–Ω–æ—Å—Ç—å', '—Ä–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å',
                '–¥–µ–ø—Ä–µ—Å—Å–∏—è', '–∞–ø–∞—Ç–∏—è', '—Å–æ–Ω–ª–∏–≤–æ—Å—Ç—å', '–±–µ—Å—Å–æ–Ω–Ω–∏—Ü–∞', '—Ö–æ–ª–æ–¥–Ω—ã–µ —Ä—É–∫–∏',
                '–Ω–µ–ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å —Ö–æ–ª–æ–¥–∞', '–Ω–µ–ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ—Å—Ç—å –∂–∞—Ä—ã', '–∏–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–æ—Å—Ç–∞'
            ],
            'urogenital': [
                '–±–æ–ª—å –ø—Ä–∏ –º–æ—á–µ–∏—Å–ø—É—Å–∫–∞–Ω–∏–∏', '—á–∞—Å—Ç–æ–µ –º–æ—á–µ–∏—Å–ø—É—Å–∫–∞–Ω–∏–µ', '—Ä–µ–¥–∫–æ–µ –º–æ—á–µ–∏—Å–ø—É—Å–∫–∞–Ω–∏–µ',
                '–∫—Ä–æ–≤—å –≤ –º–æ—á–µ', '–º—É—Ç–Ω–∞—è –º–æ—á–∞', '—Ç–µ–º–Ω–∞—è –º–æ—á–∞', '—Å–≤–µ—Ç–ª–∞—è –º–æ—á–∞',
                '–±–æ–ª—å –≤ –ø–æ—è—Å–Ω–∏—Ü–µ', '–±–æ–ª—å –≤ –±–æ–∫—É', '–æ—Ç–µ–∫–∏', '–ø–æ–≤—ã—à–µ–Ω–Ω–æ–µ –¥–∞–≤–ª–µ–Ω–∏–µ',
                '–±–µ–ª–æ–∫ –≤ –º–æ—á–µ', '—Å–∞—Ö–∞—Ä –≤ –º–æ—á–µ', '–±–æ–ª—å –≤ –º–æ—á–µ–≤–æ–º –ø—É–∑—ã—Ä–µ',
                '–Ω–µ–¥–µ—Ä–∂–∞–Ω–∏–µ –º–æ—á–∏', '–∑–∞–¥–µ—Ä–∂–∫–∞ –º–æ—á–∏', '–∂–∂–µ–Ω–∏–µ –ø—Ä–∏ –º–æ—á–µ–∏—Å–ø—É—Å–∫–∞–Ω–∏–∏',
                '–±–æ–ª—å –≤ –ø–æ–ª–æ–≤—ã—Ö –æ—Ä–≥–∞–Ω–∞—Ö', '–≤—ã–¥–µ–ª–µ–Ω–∏—è', '–∑—É–¥ –≤ –ø–æ–ª–æ–≤—ã—Ö –æ—Ä–≥–∞–Ω–∞—Ö',
                '–Ω–∞—Ä—É—à–µ–Ω–∏–µ –ø–æ—Ç–µ–Ω—Ü–∏–∏', '–±–æ–ª—å –ø—Ä–∏ –ø–æ–ª–æ–≤–æ–º –∞–∫—Ç–µ', '–∫—Ä–æ–≤–æ—Ç–µ—á–µ–Ω–∏—è'
            ],
            'ophthalmologic': [
                '–Ω–∞—Ä—É—à–µ–Ω–∏–µ –∑—Ä–µ–Ω–∏—è', '–±–æ–ª—å –≤ –≥–ª–∞–∑–∞—Ö', '–ø–æ–∫—Ä–∞—Å–Ω–µ–Ω–∏–µ –≥–ª–∞–∑', '—Å–ª–µ–∑–æ—Ç–µ—á–µ–Ω–∏–µ',
                '—Å—É—Ö–æ—Å—Ç—å –≥–ª–∞–∑', '–∑—É–¥ –≤ –≥–ª–∞–∑–∞—Ö', '–∂–∂–µ–Ω–∏–µ –≤ –≥–ª–∞–∑–∞—Ö', '—Å–≤–µ—Ç–æ–±–æ—è–∑–Ω—å',
                '–¥–≤–æ–µ–Ω–∏–µ –≤ –≥–ª–∞–∑–∞—Ö', '–º—É—à–∫–∏ –ø–µ—Ä–µ–¥ –≥–ª–∞–∑–∞–º–∏', '–≤—Å–ø—ã—à–∫–∏ –ø–µ—Ä–µ–¥ –≥–ª–∞–∑–∞–º–∏',
                '–ø—è—Ç–Ω–∞ –ø–µ—Ä–µ–¥ –≥–ª–∞–∑–∞–º–∏', '—Å–Ω–∏–∂–µ–Ω–∏–µ –æ—Å—Ç—Ä–æ—Ç—ã –∑—Ä–µ–Ω–∏—è', '–ø–æ—Ç–µ—Ä—è –ø–æ–ª—è –∑—Ä–µ–Ω–∏—è',
                '–∫—É—Ä–∏–Ω–∞—è —Å–ª–µ–ø–æ—Ç–∞', '–±–æ–ª—å –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ –≥–ª–∞–∑', '–≤—ã–¥–µ–ª–µ–Ω–∏—è –∏–∑ –≥–ª–∞–∑',
                '–æ—Ç–µ–∫ –≤–µ–∫', '–æ–ø—É—â–µ–Ω–∏–µ –≤–µ–∫', '–≤–æ—Å–ø–∞–ª–µ–Ω–∏–µ –≤–µ–∫', '—è—á–º–µ–Ω—å', '—Ö–∞–ª—è–∑–∏–æ–Ω'
            ],
            'otolaryngologic': [
                '–±–æ–ª—å –≤ —É—Ö–µ', '—Å–Ω–∏–∂–µ–Ω–∏–µ —Å–ª—É—Ö–∞', '—à—É–º –≤ —É—à–∞—Ö', '–∑–≤–æ–Ω –≤ —É—à–∞—Ö',
                '–≤—ã–¥–µ–ª–µ–Ω–∏—è –∏–∑ —É—Ö–∞', '–∑—É–¥ –≤ —É—Ö–µ', '–∑–∞–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å —É—Ö–∞', '–≥–æ–ª–æ–≤–æ–∫—Ä—É–∂–µ–Ω–∏–µ',
                '—Ç–æ—à–Ω–æ—Ç–∞', '—Ä–≤–æ—Ç–∞', '–Ω–∞—Ä—É—à–µ–Ω–∏–µ —Ä–∞–≤–Ω–æ–≤–µ—Å–∏—è', '–±–æ–ª—å –≤ –≥–æ—Ä–ª–µ',
                '–ø–µ—Ä—à–µ–Ω–∏–µ –≤ –≥–æ—Ä–ª–µ', '—Å—É—Ö–æ—Å—Ç—å –≤ –≥–æ—Ä–ª–µ', '–æ—Å–∏–ø–ª–æ—Å—Ç—å –≥–æ–ª–æ—Å–∞',
                '–ø–æ—Ç–µ—Ä—è –≥–æ–ª–æ—Å–∞', '–∫–∞—à–µ–ª—å', '–±–æ–ª—å –ø—Ä–∏ –≥–ª–æ—Ç–∞–Ω–∏–∏', '—É–≤–µ–ª–∏—á–µ–Ω–∏–µ –ª–∏–º—Ñ–æ—É–∑–ª–æ–≤',
                '–∑–∞–ª–æ–∂–µ–Ω–Ω–æ—Å—Ç—å –Ω–æ—Å–∞', '–Ω–∞—Å–º–æ—Ä–∫', '—á–∏—Ö–∞–Ω–∏–µ', '–ø–æ—Ç–µ—Ä—è –æ–±–æ–Ω—è–Ω–∏—è'
            ],
            'psychiatric': [
                '—Ç—Ä–µ–≤–æ–∂–Ω–æ—Å—Ç—å', '–¥–µ–ø—Ä–µ—Å—Å–∏—è', '—Ä–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–∞–≥—Ä–µ—Å—Å–∏–≤–Ω–æ—Å—Ç—å',
                '–∞–ø–∞—Ç–∏—è', '–±–µ—Å–ø–æ–∫–æ–π—Å—Ç–≤–æ', '—Å—Ç—Ä–∞—Ö–∏', '—Ñ–æ–±–∏–∏', '–ø–∞–Ω–∏—á–µ—Å–∫–∏–µ –∞—Ç–∞–∫–∏',
                '–Ω–∞–≤—è–∑—á–∏–≤—ã–µ –º—ã—Å–ª–∏', '–Ω–∞–≤—è–∑—á–∏–≤—ã–µ –¥–µ–π—Å—Ç–≤–∏—è', '–≥–∞–ª–ª—é—Ü–∏–Ω–∞—Ü–∏–∏',
                '–±—Ä–µ–¥', '–Ω–∞—Ä—É—à–µ–Ω–∏–µ —Å–Ω–∞', '–±–µ—Å—Å–æ–Ω–Ω–∏—Ü–∞', '–∫–æ—à–º–∞—Ä—ã', '—Å–æ–Ω–ª–∏–≤–æ—Å—Ç—å',
                '–Ω–∞—Ä—É—à–µ–Ω–∏–µ –∞–ø–ø–µ—Ç–∏—Ç–∞', '–Ω–∞—Ä—É—à–µ–Ω–∏–µ –∫–æ–Ω—Ü–µ–Ω—Ç—Ä–∞—Ü–∏–∏', '–∑–∞–±—ã–≤—á–∏–≤–æ—Å—Ç—å',
                '—Å–ø—É—Ç–∞–Ω–Ω–æ—Å—Ç—å —Å–æ–∑–Ω–∞–Ω–∏—è', '–¥–µ–∑–æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—è', '—Å—É–∏—Ü–∏–¥–∞–ª—å–Ω—ã–µ –º—ã—Å–ª–∏',
                '–ø–µ—Ä–µ–ø–∞–¥—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è', '—ç–π—Ñ–æ—Ä–∏—è', '–º–∞–Ω–∏—è', '–ø—Å–∏—Ö–æ–º–æ—Ç–æ—Ä–Ω–æ–µ –≤–æ–∑–±—É–∂–¥–µ–Ω–∏–µ'
            ]
        }
        
        # –û–≥—Ä–æ–º–Ω–∞—è –±–∞–∑–∞ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –ø–æ —Å–∏—Å—Ç–µ–º–∞–º
        self.diseases_database = {
            'respiratory': [
                '–ë—Ä–æ–Ω—Ö–∏—Ç –æ—Å—Ç—Ä—ã–π', '–ë—Ä–æ–Ω—Ö–∏—Ç —Ö—Ä–æ–Ω–∏—á–µ—Å–∫–∏–π', '–ü–Ω–µ–≤–º–æ–Ω–∏—è', '–¢—Ä–∞—Ö–µ–∏—Ç',
                '–õ–∞—Ä–∏–Ω–≥–∏—Ç', '–§–∞—Ä–∏–Ω–≥–∏—Ç', '–°–∏–Ω—É—Å–∏—Ç', '–†–∏–Ω–∏—Ç', '–ê—Å—Ç–º–∞ –±—Ä–æ–Ω—Ö–∏–∞–ª—å–Ω–∞—è',
                '–•–û–ë–õ', '–ü–ª–µ–≤—Ä–∏—Ç', '–ü–Ω–µ–≤–º–æ—Ç–æ—Ä–∞–∫—Å', '–≠–º—Ñ–∏–∑–µ–º–∞', '–ë—Ä–æ–Ω—Ö–æ—ç–∫—Ç–∞–∑—ã',
                '–õ–µ–≥–æ—á–Ω–∞—è —ç–º–±–æ–ª–∏—è', '–û—Ç–µ–∫ –ª–µ–≥–∫–∏—Ö', '–§–∏–±—Ä–æ–∑ –ª–µ–≥–∫–∏—Ö', '–°–∞—Ä–∫–æ–∏–¥–æ–∑',
                '–¢—É–±–µ—Ä–∫—É–ª–µ–∑', '–†–∞–∫ –ª–µ–≥–∫–∏—Ö', '–ö–æ–∫–ª—é—à', '–ì—Ä–∏–ø–ø', '–û–†–í–ò',
                '–ë—Ä–æ–Ω—Ö–∏–æ–ª–∏—Ç', '–ê–ª—å–≤–µ–æ–ª–∏—Ç', '–°–∏–ª–∏–∫–æ–∑', '–ê—Å–±–µ—Å—Ç–æ–∑', '–ü–Ω–µ–≤–º–æ–∫–æ–Ω–∏–æ–∑'
            ],
            'cardiovascular': [
                '–ì–∏–ø–µ—Ä—Ç–æ–Ω–∏—è', '–ì–∏–ø–æ—Ç–æ–Ω–∏—è', '–ò–ë–°', '–°—Ç–µ–Ω–æ–∫–∞—Ä–¥–∏—è', '–ò–Ω—Ñ–∞—Ä–∫—Ç –º–∏–æ–∫–∞—Ä–¥–∞',
                '–ê—Ä–∏—Ç–º–∏—è', '–¢–∞—Ö–∏–∫–∞—Ä–¥–∏—è', '–ë—Ä–∞–¥–∏–∫–∞—Ä–¥–∏—è', '–§–∏–±—Ä–∏–ª–ª—è—Ü–∏—è –ø—Ä–µ–¥—Å–µ—Ä–¥–∏–π',
                '–°–µ—Ä–¥–µ—á–Ω–∞—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å', '–ö–∞—Ä–¥–∏–æ–º–∏–æ–ø–∞—Ç–∏—è', '–ú–∏–æ–∫–∞—Ä–¥–∏—Ç',
                '–ü–µ—Ä–∏–∫–∞—Ä–¥–∏—Ç', '–≠–Ω–¥–æ–∫–∞—Ä–¥–∏—Ç', '–ü–æ—Ä–æ–∫–∏ —Å–µ—Ä–¥—Ü–∞', '–ê—Ç–µ—Ä–æ—Å–∫–ª–µ—Ä–æ–∑',
                '–¢—Ä–æ–º–±–æ–∑', '–≠–º–±–æ–ª–∏—è', '–í–∞—Ä–∏–∫–æ–∑–Ω–æ–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≤–µ–Ω', '–¢—Ä–æ–º–±–æ—Ñ–ª–µ–±–∏—Ç',
                '–û–±–ª–∏—Ç–µ—Ä–∏—Ä—É—é—â–∏–π —ç–Ω–¥–∞—Ä—Ç–µ—Ä–∏–∏—Ç', '–ê–Ω–µ–≤—Ä–∏–∑–º–∞ –∞–æ—Ä—Ç—ã', '–ö–∞—Ä–¥–∏–æ—Å–∫–ª–µ—Ä–æ–∑',
                '–≠–∫—Å—Ç—Ä–∞—Å–∏—Å—Ç–æ–ª–∏—è', '–ë–ª–æ–∫–∞–¥–∞ —Å–µ—Ä–¥—Ü–∞', '–°–∏–Ω–¥—Ä–æ–º WPW', '–ö–∞—Ä–¥–∏–æ–º–µ–≥–∞–ª–∏—è'
            ],
            'gastrointestinal': [
                '–ì–∞—Å—Ç—Ä–∏—Ç', '–Ø–∑–≤–∞ –∂–µ–ª—É–¥–∫–∞', '–Ø–∑–≤–∞ –¥–≤–µ–Ω–∞–¥—Ü–∞—Ç–∏–ø–µ—Ä—Å—Ç–Ω–æ–π –∫–∏—à–∫–∏', '–î—É–æ–¥–µ–Ω–∏—Ç',
                '–≠–∑–æ—Ñ–∞–≥–∏—Ç', '–ì–≠–†–ë', '–ö–æ–ª–∏—Ç', '–≠–Ω—Ç–µ—Ä–∏—Ç', '–ì–∞—Å—Ç—Ä–æ—ç–Ω—Ç–µ—Ä–∏—Ç', '–ü—Ä–æ–∫—Ç–∏—Ç',
                '–ì–µ–º–æ—Ä—Ä–æ–π', '–¢—Ä–µ—â–∏–Ω–∞ –ø—Ä—è–º–æ–π –∫–∏—à–∫–∏', '–î–∏–≤–µ—Ä—Ç–∏–∫—É–ª–µ–∑', '–ê–ø–ø–µ–Ω–¥–∏—Ü–∏—Ç',
                '–•–æ–ª–µ—Ü–∏—Å—Ç–∏—Ç', '–ñ–µ–ª—á–Ω–æ–∫–∞–º–µ–Ω–Ω–∞—è –±–æ–ª–µ–∑–Ω—å', '–ü–∞–Ω–∫—Ä–µ–∞—Ç–∏—Ç', '–ì–µ–ø–∞—Ç–∏—Ç',
                '–¶–∏—Ä—Ä–æ–∑ –ø–µ—á–µ–Ω–∏', '–†–∞–∫ –∂–µ–ª—É–¥–∫–∞', '–†–∞–∫ —Ç–æ–ª—Å—Ç–æ–π –∫–∏—à–∫–∏', '–ü–æ–ª–∏–ø—ã –∫–∏—à–µ—á–Ω–∏–∫–∞',
                '–ë–æ–ª–µ–∑–Ω—å –ö—Ä–æ–Ω–∞', '–ù–µ—Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–π —è–∑–≤–µ–Ω–Ω—ã–π –∫–æ–ª–∏—Ç', '–°–∏–Ω–¥—Ä–æ–º —Ä–∞–∑–¥—Ä–∞–∂–µ–Ω–Ω–æ–≥–æ –∫–∏—à–µ—á–Ω–∏–∫–∞',
                '–ú–∞–ª—å–∞–±—Å–æ—Ä–±—Ü–∏—è', '–¶–µ–ª–∏–∞–∫–∏—è', '–õ–∞–∫—Ç–∞–∑–Ω–∞—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å'
            ],
            'neurological': [
                '–ú–∏–≥—Ä–µ–Ω—å', '–ì–æ–ª–æ–≤–Ω–∞—è –±–æ–ª—å –Ω–∞–ø—Ä—è–∂–µ–Ω–∏—è', '–ö–ª–∞—Å—Ç–µ—Ä–Ω–∞—è –≥–æ–ª–æ–≤–Ω–∞—è –±–æ–ª—å',
                '–≠–ø–∏–ª–µ–ø—Å–∏—è', '–ò–Ω—Å—É–ª—å—Ç', '–¢—Ä–∞–Ω–∑–∏—Ç–æ—Ä–Ω–∞—è –∏—à–µ–º–∏—á–µ—Å–∫–∞—è –∞—Ç–∞–∫–∞', '–ë–æ–ª–µ–∑–Ω—å –ü–∞—Ä–∫–∏–Ω—Å–æ–Ω–∞',
                '–ë–æ–ª–µ–∑–Ω—å –ê–ª—å—Ü–≥–µ–π–º–µ—Ä–∞', '–î–µ–º–µ–Ω—Ü–∏—è', '–†–∞—Å—Å–µ—è–Ω–Ω—ã–π —Å–∫–ª–µ—Ä–æ–∑', '–ù–µ–≤—Ä–∞–ª–≥–∏—è',
                '–ù–µ–≤—Ä–∏—Ç', '–ü–æ–ª–∏–Ω–µ–π—Ä–æ–ø–∞—Ç–∏—è', '–†–∞–¥–∏–∫—É–ª–∏—Ç', '–û—Å—Ç–µ–æ—Ö–æ–Ω–¥—Ä–æ–∑', '–ì—Ä—ã–∂–∞ –¥–∏—Å–∫–∞',
                '–ú–µ–Ω–∏–Ω–≥–∏—Ç', '–≠–Ω—Ü–µ—Ñ–∞–ª–∏—Ç', '–û–ø—É—Ö–æ–ª—å –º–æ–∑–≥–∞', '–ì–∏–¥—Ä–æ—Ü–µ—Ñ–∞–ª–∏—è',
                '–ú–∏–∞—Å—Ç–µ–Ω–∏—è', '–î–∏—Å—Ç–æ–Ω–∏—è', '–¢—Ä–µ–º–æ—Ä', '–•–æ—Ä–µ—è', '–ê—Ç–∞–∫—Å–∏—è',
                '–ù–∞—Ä–∫–æ–ª–µ–ø—Å–∏—è', '–ë–µ—Å—Å–æ–Ω–Ω–∏—Ü–∞', '–°–∏–Ω–¥—Ä–æ–º –±–µ—Å–ø–æ–∫–æ–π–Ω—ã—Ö –Ω–æ–≥'
            ],
            'musculoskeletal': [
                '–ê—Ä—Ç—Ä–∏—Ç —Ä–µ–≤–º–∞—Ç–æ–∏–¥–Ω—ã–π', '–û—Å—Ç–µ–æ–∞—Ä—Ç—Ä–∏—Ç', '–ü–æ–¥–∞–≥—Ä–∞', '–ê—Ä—Ç—Ä–æ–∑',
                '–ë—É—Ä—Å–∏—Ç', '–¢–µ–Ω–¥–∏–Ω–∏—Ç', '–ú–∏–æ–∑–∏—Ç', '–§–∏–±—Ä–æ–º–∏–∞–ª–≥–∏—è', '–û—Å—Ç–µ–æ–ø–æ—Ä–æ–∑',
                '–û—Å—Ç–µ–æ–º–∏–µ–ª–∏—Ç', '–°–∫–æ–ª–∏–æ–∑', '–ö–∏—Ñ–æ–∑', '–õ–æ—Ä–¥–æ–∑', '–°–ø–æ–Ω–¥–∏–ª–µ–∑',
                '–°–ø–æ–Ω–¥–∏–ª–æ–∞—Ä—Ç—Ä–æ–∑', '–ê–Ω–∫–∏–ª–æ–∑–∏—Ä—É—é—â–∏–π —Å–ø–æ–Ω–¥–∏–ª–æ–∞—Ä—Ç—Ä–∏—Ç', '–ü—Å–æ—Ä–∏–∞—Ç–∏—á–µ—Å–∫–∏–π –∞—Ä—Ç—Ä–∏—Ç',
                '–†–µ–∞–∫—Ç–∏–≤–Ω—ã–π –∞—Ä—Ç—Ä–∏—Ç', '–°–∏—Å—Ç–µ–º–Ω–∞—è –∫—Ä–∞—Å–Ω–∞—è –≤–æ–ª—á–∞–Ω–∫–∞', '–°–∫–ª–µ—Ä–æ–¥–µ—Ä–º–∏—è',
                '–î–µ—Ä–º–∞—Ç–æ–º–∏–æ–∑–∏—Ç', '–ü–æ–ª–∏–º–∏–æ–∑–∏—Ç', '–°–∏–Ω–¥—Ä–æ–º –®–µ–≥—Ä–µ–Ω–∞', '–í–∞—Å–∫—É–ª–∏—Ç',
                '–ü–µ—Ä–∏–∞—Ä—Ç—Ä–∏—Ç', '–≠–ø–∏–∫–æ–Ω–¥–∏–ª–∏—Ç', '–¢—É–Ω–Ω–µ–ª—å–Ω—ã–π —Å–∏–Ω–¥—Ä–æ–º', '–ö–æ–Ω—Ç—Ä–∞–∫—Ç—É—Ä–∞'
            ],
            'dermatological': [
                '–î–µ—Ä–º–∞—Ç–∏—Ç –∞—Ç–æ–ø–∏—á–µ—Å–∫–∏–π', '–î–µ—Ä–º–∞—Ç–∏—Ç –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π', '–î–µ—Ä–º–∞—Ç–∏—Ç —Å–µ–±–æ—Ä–µ–π–Ω—ã–π',
                '–≠–∫–∑–µ–º–∞', '–ü—Å–æ—Ä–∏–∞–∑', '–ù–µ–π—Ä–æ–¥–µ—Ä–º–∏—Ç', '–ö—Ä–∞–ø–∏–≤–Ω–∏—Ü–∞', '–í–∏—Ç–∏–ª–∏–≥–æ',
                '–ê–ª–æ–ø–µ—Ü–∏—è', '–ê–∫–Ω–µ', '–†–æ–∑–∞—Ü–µ–∞', '–ì–µ—Ä–ø–µ—Å', '–û–ø–æ—è—Å—ã–≤–∞—é—â–∏–π –ª–∏—à–∞–π',
                '–ú–∏–∫–æ–∑', '–ö–∞–Ω–¥–∏–¥–æ–∑', '–ò–º–ø–µ—Ç–∏–≥–æ', '–§—É—Ä—É–Ω–∫—É–ª–µ–∑', '–ö–∞—Ä–±—É–Ω–∫—É–ª',
                '–§–ª–µ–≥–º–æ–Ω–∞', '–†–æ–∂–∏—Å—Ç–æ–µ –≤–æ—Å–ø–∞–ª–µ–Ω–∏–µ', '–°–∫–ª–µ—Ä–æ–¥–µ—Ä–º–∏—è', '–ö—Ä–∞—Å–Ω—ã–π –ø–ª–æ—Å–∫–∏–π –ª–∏—à–∞–π',
                '–ü—É–∑—ã—Ä—á–∞—Ç–∫–∞', '–ü–µ–º—Ñ–∏–≥–æ–∏–¥', '–ú–µ–ª–∞–Ω–æ–º–∞', '–ë–∞–∑–∞–ª–∏–æ–º–∞', '–ö–µ—Ä–∞—Ç–æ–∑',
                '–ü–∞–ø–∏–ª–ª–æ–º–∞', '–ë–æ—Ä–æ–¥–∞–≤–∫–∏', '–ö–æ–Ω–¥–∏–ª–æ–º—ã', '–ö–µ–ª–æ–∏–¥–Ω—ã–µ —Ä—É–±—Ü—ã'
            ],
            'endocrine': [
                '–°–∞—Ö–∞—Ä–Ω—ã–π –¥–∏–∞–±–µ—Ç 1 —Ç–∏–ø–∞', '–°–∞—Ö–∞—Ä–Ω—ã–π –¥–∏–∞–±–µ—Ç 2 —Ç–∏–ø–∞', '–ì–∏–ø–æ—Ç–∏—Ä–µ–æ–∑',
                '–ì–∏–ø–µ—Ä—Ç–∏—Ä–µ–æ–∑', '–¢–∏—Ä–µ–æ—Ç–æ–∫—Å–∏–∫–æ–∑', '–ó–æ–±', '–¢–∏—Ä–µ–æ–∏–¥–∏—Ç', '–ë–æ–ª–µ–∑–Ω—å –ì—Ä–µ–π–≤—Å–∞',
                '–ë–æ–ª–µ–∑–Ω—å –•–∞—à–∏–º–æ—Ç–æ', '–£–∑–ª–æ–≤–æ–π –∑–æ–±', '–†–∞–∫ —â–∏—Ç–æ–≤–∏–¥–Ω–æ–π –∂–µ–ª–µ–∑—ã',
                '–ì–∏–ø–µ—Ä–ø–∞—Ä–∞—Ç–∏—Ä–µ–æ–∑', '–ì–∏–ø–æ–ø–∞—Ä–∞—Ç–∏—Ä–µ–æ–∑', '–ë–æ–ª–µ–∑–Ω—å –ê–¥–¥–∏—Å–æ–Ω–∞',
                '–°–∏–Ω–¥—Ä–æ–º –ö—É—à–∏–Ω–≥–∞', '–§–µ–æ—Ö—Ä–æ–º–æ—Ü–∏—Ç–æ–º–∞', '–ì–∏–ø–µ—Ä–∞–ª—å–¥–æ—Å—Ç–µ—Ä–æ–Ω–∏–∑–º',
                '–ù–µ—Å–∞—Ö–∞—Ä–Ω—ã–π –¥–∏–∞–±–µ—Ç', '–ê–∫—Ä–æ–º–µ–≥–∞–ª–∏—è', '–ì–∏–ø–æ–ø–∏—Ç—É–∏—Ç–∞—Ä–∏–∑–º',
                '–ü—Ä–æ–ª–∞–∫—Ç–∏–Ω–æ–º–∞', '–°–∏–Ω–¥—Ä–æ–º –ø–æ–ª–∏–∫–∏—Å—Ç–æ–∑–Ω—ã—Ö —è–∏—á–Ω–∏–∫–æ–≤', '–ì–∏–Ω–µ–∫–æ–º–∞—Å—Ç–∏—è',
                '–û–∂–∏—Ä–µ–Ω–∏–µ', '–ú–µ—Ç–∞–±–æ–ª–∏—á–µ—Å–∫–∏–π —Å–∏–Ω–¥—Ä–æ–º', '–ì–∏–ø–µ—Ä–ª–∏–ø–∏–¥–µ–º–∏—è'
            ],
            'urogenital': [
                '–ü–∏–µ–ª–æ–Ω–µ—Ñ—Ä–∏—Ç', '–ì–ª–æ–º–µ—Ä—É–ª–æ–Ω–µ—Ñ—Ä–∏—Ç', '–¶–∏—Å—Ç–∏—Ç', '–£—Ä–µ—Ç—Ä–∏—Ç', '–ü—Ä–æ—Å—Ç–∞—Ç–∏—Ç',
                '–ê–¥–µ–Ω–æ–º–∞ –ø—Ä–æ—Å—Ç–∞—Ç—ã', '–†–∞–∫ –ø—Ä–æ—Å—Ç–∞—Ç—ã', '–ú–æ—á–µ–∫–∞–º–µ–Ω–Ω–∞—è –±–æ–ª–µ–∑–Ω—å',
                '–ü–æ—á–µ—á–Ω–∞—è –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ—Å—Ç—å', '–ù–µ—Ñ—Ä–æ—Ç–∏—á–µ—Å–∫–∏–π —Å–∏–Ω–¥—Ä–æ–º', '–ù–µ—Ñ—Ä–∏—Ç',
                '–ì–∏–¥—Ä–æ–Ω–µ—Ñ—Ä–æ–∑', '–ü–æ–ª–∏–∫–∏—Å—Ç–æ–∑ –ø–æ—á–µ–∫', '–†–∞–∫ –ø–æ—á–∫–∏', '–†–∞–∫ –º–æ—á–µ–≤–æ–≥–æ –ø—É–∑—ã—Ä—è',
                '–ù–µ–¥–µ—Ä–∂–∞–Ω–∏–µ –º–æ—á–∏', '–≠–Ω—É—Ä–µ–∑', '–ë–∞–ª–∞–Ω–æ–ø–æ—Å—Ç–∏—Ç', '–û—Ä—Ö–∏—Ç', '–≠–ø–∏–¥–∏–¥–∏–º–∏—Ç',
                '–í–∞—Ä–∏–∫–æ—Ü–µ–ª–µ', '–ì–∏–¥—Ä–æ—Ü–µ–ª–µ', '–ö—Ä–∏–ø—Ç–æ—Ä—Ö–∏–∑–º', '–§–∏–º–æ–∑', '–ü–∞—Ä–∞—Ñ–∏–º–æ–∑',
                '–≠—Ä–µ–∫—Ç–∏–ª—å–Ω–∞—è –¥–∏—Å—Ñ—É–Ω–∫—Ü–∏—è', '–ë–µ—Å–ø–ª–æ–¥–∏–µ –º—É–∂—Å–∫–æ–µ', '–ë–µ—Å–ø–ª–æ–¥–∏–µ –∂–µ–Ω—Å–∫–æ–µ'
            ],
            'ophthalmologic': [
                '–ë–ª–∏–∑–æ—Ä—É–∫–æ—Å—Ç—å', '–î–∞–ª—å–Ω–æ–∑–æ—Ä–∫–æ—Å—Ç—å', '–ê—Å—Ç–∏–≥–º–∞—Ç–∏–∑–º', '–ö–∞—Ç–∞—Ä–∞–∫—Ç–∞',
                '–ì–ª–∞—É–∫–æ–º–∞', '–ö–æ–Ω—ä—é–Ω–∫—Ç–∏–≤–∏—Ç', '–ë–ª–µ—Ñ–∞—Ä–∏—Ç', '–Ø—á–º–µ–Ω—å', '–•–∞–ª—è–∑–∏–æ–Ω',
                '–ö–µ—Ä–∞—Ç–∏—Ç', '–£–≤–µ–∏—Ç', '–†–µ—Ç–∏–Ω–∏—Ç', '–û—Ç—Å–ª–æ–π–∫–∞ —Å–µ—Ç—á–∞—Ç–∫–∏', '–î–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏—è —Å–µ—Ç—á–∞—Ç–∫–∏',
                '–î–∏–∞–±–µ—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ—Ç–∏–Ω–æ–ø–∞—Ç–∏—è', '–ì–∏–ø–µ—Ä—Ç–æ–Ω–∏—á–µ—Å–∫–∞—è —Ä–µ—Ç–∏–Ω–æ–ø–∞—Ç–∏—è',
                '–ù–µ–≤—Ä–∏—Ç –∑—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ –Ω–µ—Ä–≤–∞', '–ê–º–±–ª–∏–æ–ø–∏—è', '–ö–æ—Å–æ–≥–ª–∞–∑–∏–µ', '–ù–∏—Å—Ç–∞–≥–º',
                '–ü—Ç–æ–∑', '–≠–∫—Ç—Ä–æ–ø–∏–æ–Ω', '–≠–Ω—Ç—Ä–æ–ø–∏–æ–Ω', '–¢—Ä–∏—Ö–∏–∞–∑', '–î–∞–∫—Ä–∏–æ—Ü–∏—Å—Ç–∏—Ç',
                '–°–∏–Ω–¥—Ä–æ–º —Å—É—Ö–æ–≥–æ –≥–ª–∞–∑–∞', '–ê–ª–ª–µ—Ä–≥–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—ä—é–Ω–∫—Ç–∏–≤–∏—Ç'
            ],
            'otolaryngologic': [
                '–û—Ç–∏—Ç –Ω–∞—Ä—É–∂–Ω—ã–π', '–û—Ç–∏—Ç —Å—Ä–µ–¥–Ω–∏–π', '–û—Ç–∏—Ç –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π', '–¢—É–≥–æ—É—Ö–æ—Å—Ç—å',
                '–ì–ª—É—Ö–æ—Ç–∞', '–ë–æ–ª–µ–∑–Ω—å –ú–µ–Ω—å–µ—Ä–∞', '–û—Ç–æ—Å–∫–ª–µ—Ä–æ–∑', '–°–µ—Ä–Ω–∞—è –ø—Ä–æ–±–∫–∞',
                '–ü–µ—Ä—Ñ–æ—Ä–∞—Ü–∏—è –±–∞—Ä–∞–±–∞–Ω–Ω–æ–π –ø–µ—Ä–µ–ø–æ–Ω–∫–∏', '–ú–∞—Å—Ç–æ–∏–¥–∏—Ç', '–õ–∞–±–∏—Ä–∏–Ω—Ç–∏—Ç',
                '–ê–Ω–≥–∏–Ω–∞', '–§–∞—Ä–∏–Ω–≥–∏—Ç', '–õ–∞—Ä–∏–Ω–≥–∏—Ç', '–¢—Ä–∞—Ö–µ–∏—Ç', '–¢–æ–Ω–∑–∏–ª–ª–∏—Ç',
                '–ü–∞—Ä–∞—Ç–æ–Ω–∑–∏–ª–ª—è—Ä–Ω—ã–π –∞–±—Å—Ü–µ—Å—Å', '–†–∏–Ω–∏—Ç', '–°–∏–Ω—É—Å–∏—Ç', '–ü–æ–ª–∏–ø—ã –Ω–æ—Å–∞',
                '–ò—Å–∫—Ä–∏–≤–ª–µ–Ω–∏–µ –Ω–æ—Å–æ–≤–æ–π –ø–µ—Ä–µ–≥–æ—Ä–æ–¥–∫–∏', '–ê–¥–µ–Ω–æ–∏–¥—ã', '–•—Ä–∞–ø',
                '–ê–ø–Ω–æ—ç —Å–Ω–∞', '–ü–∞–ø–∏–ª–ª–æ–º–∞ –≥–æ—Ä—Ç–∞–Ω–∏', '–†–∞–∫ –≥–æ—Ä—Ç–∞–Ω–∏', '–†–∞–∫ –Ω–æ—Å–æ–≥–ª–æ—Ç–∫–∏'
            ],
            'psychiatric': [
                '–î–µ–ø—Ä–µ—Å—Å–∏—è', '–ë–∏–ø–æ–ª—è—Ä–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ', '–¢—Ä–µ–≤–æ–∂–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ',
                '–ü–∞–Ω–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ', '–ì–µ–Ω–µ—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —Ç—Ä–µ–≤–æ–∂–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ',
                '–§–æ–±–∏–∏', '–û–±—Å–µ—Å—Å–∏–≤–Ω–æ-–∫–æ–º–ø—É–ª—å—Å–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ', '–ü–æ—Å—Ç—Ç—Ä–∞–≤–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ç—Ä–µ—Å—Å–æ–≤–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ',
                '–®–∏–∑–æ—Ñ—Ä–µ–Ω–∏—è', '–®–∏–∑–æ–∞—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ', '–ë—Ä–µ–¥–æ–≤–æ–µ —Ä–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–æ',
                '–î–µ–º–µ–Ω—Ü–∏—è', '–ë–æ–ª–µ–∑–Ω—å –ê–ª—å—Ü–≥–µ–π–º–µ—Ä–∞', '–î–µ–ª–∏—Ä–∏–π', '–†–∞—Å—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ –ª–∏—á–Ω–æ—Å—Ç–∏',
                '–ê–Ω–æ—Ä–µ–∫—Å–∏—è', '–ë—É–ª–∏–º–∏—è', '–ê–ª–∫–æ–≥–æ–ª–∏–∑–º', '–ù–∞—Ä–∫–æ–º–∞–Ω–∏—è', '–¢–æ–∫—Å–∏–∫–æ–º–∞–Ω–∏—è',
                '–ò–≥—Ä–æ–º–∞–Ω–∏—è', '–°–∏–Ω–¥—Ä–æ–º –¥–µ—Ñ–∏—Ü–∏—Ç–∞ –≤–Ω–∏–º–∞–Ω–∏—è', '–ê—É—Ç–∏–∑–º', '–î–∏—Å–ª–µ–∫—Å–∏—è',
                '–≠–Ω—É—Ä–µ–∑', '–≠–Ω–∫–æ–ø—Ä–µ–∑', '–ó–∞–∏–∫–∞–Ω–∏–µ', '–¢–∏–∫–∏', '–°–∏–Ω–¥—Ä–æ–º –¢—É—Ä–µ—Ç—Ç–∞'
            ]
        }
        
        # –£—Ä–æ–≤–Ω–∏ —Ç—è–∂–µ—Å—Ç–∏ —Å –≤–µ—Å–∞–º–∏
        self.severity_levels = {
            'very_low': {'weight': 0.3, 'symptoms_count': (1, 2)},
            'low': {'weight': 0.25, 'symptoms_count': (2, 3)},
            'medium': {'weight': 0.2, 'symptoms_count': (3, 5)},
            'high': {'weight': 0.15, 'symptoms_count': (5, 7)},
            'very_high': {'weight': 0.1, 'symptoms_count': (7, 10)}
        }
        
        # –í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ –≥—Ä—É–ø–ø—ã
        self.age_groups = {
            'children': {'weight': 0.15, 'age_range': (0, 17)},
            'young_adults': {'weight': 0.25, 'age_range': (18, 35)},
            'adults': {'weight': 0.35, 'age_range': (36, 60)},
            'elderly': {'weight': 0.25, 'age_range': (61, 100)}
        }
        
        # –ü–æ–ª
        self.genders = ['male', 'female']
        
        logger.info("–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω –º–∞—Å—Å–∏–≤–Ω—ã–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö")
        logger.info(f"–ö–∞—Ç–µ–≥–æ—Ä–∏–π —Å–∏–º–ø—Ç–æ–º–æ–≤: {len(self.symptoms_database)}")
        logger.info(f"–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–ø—Ç–æ–º–æ–≤: {sum(len(symptoms) for symptoms in self.symptoms_database.values())}")
        logger.info(f"–û–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π: {sum(len(diseases) for diseases in self.diseases_database.values())}")
    
    def show_progress(self, current: int, total: int, start_time: float, prefix: str = "–ü—Ä–æ–≥—Ä–µ—Å—Å"):
        """–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ —Å –ø–æ–ª–æ—Å–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å–∞"""
        elapsed = time.time() - start_time
        percent = (current / total) * 100
        
        # –°–æ–∑–¥–∞–µ–º –ø–æ–ª–æ—Å—É –ø—Ä–æ–≥—Ä–µ—Å—Å–∞
        bar_length = 50
        filled_length = int(bar_length * current // total)
        bar = '‚ñà' * filled_length + '‚ñë' * (bar_length - filled_length)
        
        # –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ–º —Å–∫–æ—Ä–æ—Å—Ç—å –∏ –æ—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è
        if elapsed > 0:
            rate = current / elapsed
            remaining = (total - current) / rate if rate > 0 else 0
            eta = f"ETA: {int(remaining//60)}–º {int(remaining%60)}—Å"
        else:
            rate = 0
            eta = "ETA: --:--"
        
        print(f"\r{prefix}: |{bar}| {current:,}/{total:,} ({percent:.1f}%) - {rate:.1f} –∑–∞–ø/—Å - {eta}", end='', flush=True)
    
    def create_unique_signature(self, disease: str, symptoms: List[str]) -> str:
        """–°–æ–∑–¥–∞–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—É—é –ø–æ–¥–ø–∏—Å—å –¥–ª—è –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –±–æ–ª–µ–∑–Ω–∏ –∏ —Å–∏–º–ø—Ç–æ–º–æ–≤"""
        symptoms_sorted = sorted(symptoms)
        return f"{disease}:{','.join(symptoms_sorted)}"
    
    def is_unique_combination(self, disease: str, symptoms: List[str]) -> bool:
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –±–æ–ª–µ–∑–Ω—å-—Å–∏–º–ø—Ç–æ–º—ã"""
        signature = self.create_unique_signature(disease, symptoms)
        return signature not in self.used_combinations
    
    def mark_as_used(self, disease: str, symptoms: List[str]):
        """–û—Ç–º–µ—á–∞–µ—Ç –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—É—é"""
        signature = self.create_unique_signature(disease, symptoms)
        self.used_combinations.add(signature)
        
        # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫–∏
        self.disease_counters[disease] = self.disease_counters.get(disease, 0) + 1
        for symptom in symptoms:
            self.symptom_counters[symptom] = self.symptom_counters.get(symptom, 0) + 1
    
    def get_rare_symptoms(self, category: str, exclude: Optional[List[str]] = None) -> List[str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —Å–∏–º–ø—Ç–æ–º—ã –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"""
        if exclude is None:
            exclude = []
        
        category_symptoms = self.symptoms_database.get(category, [])
        available_symptoms = [s for s in category_symptoms if s not in exclude]
        
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —á–∞—Å—Ç–æ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (—Ä–µ–¥–∫–∏–µ –ø–µ—Ä–≤—ã–º–∏)
        available_symptoms.sort(key=lambda x: self.symptom_counters.get(x, 0))
        
        return available_symptoms
    
    def get_rare_diseases(self, category: str) -> List[str]:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏"""
        diseases = self.diseases_database.get(category, [])
        
        # –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ —á–∞—Å—Ç–æ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è (—Ä–µ–¥–∫–∏–µ –ø–µ—Ä–≤—ã–º–∏)
        diseases.sort(key=lambda x: self.disease_counters.get(x, 0))
        
        return diseases
    
    def generate_unique_symptoms_combination(self, disease: str, category: str, target_count: int, max_attempts: int = 200) -> List[str]:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ú–ê–ö–°–ò–ú–ê–õ–¨–ù–û —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–Ω—É—é —É–Ω–∏–∫–∞–ª—å–Ω—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é —Å–∏–º–ø—Ç–æ–º–æ–≤"""
        
        for attempt in range(max_attempts):
            symptoms = []
            
            # –°—Ç—Ä–∞—Ç–µ–≥–∏—è 1: –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∏–º–ø—Ç–æ–º—ã –∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (60-70%)
            primary_symptoms = self.symptoms_database.get(category, [])
            if primary_symptoms:
                # –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å–∏–º–ø—Ç–æ–º–æ–≤
                max_primary = min(max(1, target_count - 1), len(primary_symptoms))
                min_primary = min(1, max_primary)
                primary_count = random.randint(min_primary, max_primary) if max_primary >= min_primary else min_primary
                symptoms.extend(random.sample(primary_symptoms, primary_count))
            
            # –°—Ç—Ä–∞—Ç–µ–≥–∏—è 2: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏–º–ø—Ç–æ–º—ã –∏–∑ –¥—Ä—É–≥–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π (20-30%)
            remaining_count = target_count - len(symptoms)
            if remaining_count > 0:
                all_other_symptoms = []
                for other_cat in self.symptoms_database:
                    if other_cat != category:
                        all_other_symptoms.extend(self.symptoms_database[other_cat])
                
                if all_other_symptoms:
                    additional_count = min(remaining_count, len(all_other_symptoms))
                    if additional_count > 0:
                        symptoms.extend(random.sample(all_other_symptoms, additional_count))
            
            # –°—Ç—Ä–∞—Ç–µ–≥–∏—è 3: –û–±—â–∏–µ —Å–∏–º–ø—Ç–æ–º—ã –µ—Å–ª–∏ –≤—Å–µ –µ—â–µ –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç (10%)
            remaining_count = target_count - len(symptoms)
            if remaining_count > 0:
                general_symptoms = [
                    '—É—Å—Ç–∞–ª–æ—Å—Ç—å', '—Å–ª–∞–±–æ—Å—Ç—å', '–Ω–µ–¥–æ–º–æ–≥–∞–Ω–∏–µ', '–±–æ–ª—å', '–¥–∏—Å–∫–æ–º—Ñ–æ—Ä—Ç', 
                    '–≤–æ—Å–ø–∞–ª–µ–Ω–∏–µ', '–æ—Ç–µ–∫', '–ø–æ–∫—Ä–∞—Å–Ω–µ–Ω–∏–µ', '–ø–æ–≤—ã—à–µ–Ω–Ω–∞—è —Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞',
                    '–≥–æ–ª–æ–≤–æ–∫—Ä—É–∂–µ–Ω–∏–µ', '—Ç–æ—à–Ω–æ—Ç–∞', '—Ä–≤–æ—Ç–∞', '–¥–∏–∞—Ä–µ—è', '–∑–∞–ø–æ—Ä',
                    '–±–µ—Å—Å–æ–Ω–Ω–∏—Ü–∞', '–∞–ø–∞—Ç–∏—è', '—Ä–∞–∑–¥—Ä–∞–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å', '–ø–æ—Ç–µ—Ä—è –∞–ø–ø–µ—Ç–∏—Ç–∞',
                    '–ø–æ–≤—ã—à–µ–Ω–Ω–æ–µ –ø–æ—Ç–æ–æ—Ç–¥–µ–ª–µ–Ω–∏–µ', '–æ–∑–Ω–æ–±', '–∂–∞—Ä', '–ª–æ–º–æ—Ç–∞ –≤ —Ç–µ–ª–µ'
                ]
                
                available_general = [s for s in general_symptoms if s not in symptoms]
                if available_general:
                    general_count = min(remaining_count, len(available_general))
                    symptoms.extend(random.sample(available_general, general_count))
            
            # –û–±—Ä–µ–∑–∞–µ–º –¥–æ –Ω—É–∂–Ω–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
            if len(symptoms) > target_count:
                symptoms = random.sample(symptoms, target_count)
            
            # –£–±–∏—Ä–∞–µ–º –¥—É–±–ª–∏–∫–∞—Ç—ã
            symptoms = list(set(symptoms))
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å
            if self.is_unique_combination(disease, symptoms):
                return symptoms
            
            # –°—Ç—Ä–∞—Ç–µ–≥–∏—è 4: –ï—Å–ª–∏ –Ω–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ, –≤–∞—Ä—å–∏—Ä—É–µ–º –∫–æ–º–±–∏–Ω–∞—Ü–∏—é
            if len(symptoms) > 1:
                # –£–±–∏—Ä–∞–µ–º –æ–¥–∏–Ω —Å–ª—É—á–∞–π–Ω—ã–π —Å–∏–º–ø—Ç–æ–º –∏ –¥–æ–±–∞–≤–ª—è–µ–º –¥—Ä—É–≥–æ–π
                symptoms.pop(random.randint(0, len(symptoms) - 1))
                
                # –ü—Ä–æ–±—É–µ–º –¥–æ–±–∞–≤–∏—Ç—å —Ä–µ–¥–∫–∏–π —Å–∏–º–ø—Ç–æ–º –∏–∑ –ª—é–±–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
                all_symptoms = []
                for cat_symptoms in self.symptoms_database.values():
                    all_symptoms.extend([s for s in cat_symptoms if s not in symptoms])
                
                if all_symptoms:
                    symptoms.append(random.choice(all_symptoms))
                    if self.is_unique_combination(disease, symptoms):
                        return symptoms
        
        # –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Ö–æ—Ç—è –±—ã —á—Ç–æ-—Ç–æ
        print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é –¥–ª—è {disease} –∑–∞ {max_attempts} –ø–æ–ø—ã—Ç–æ–∫")
        
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å–ª—É—á–∞–π–Ω—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é
        all_available = []
        for cat_symptoms in self.symptoms_database.values():
            all_available.extend(cat_symptoms)
        
        if len(all_available) >= target_count:
            return random.sample(all_available, target_count)
        else:
            return all_available[:target_count]
    
    def generate_disease_symptom_associations(self) -> Dict[str, List[str]]:
        """–°–æ–∑–¥–∞–µ—Ç –ü–û–õ–ù–´–ï –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏ –º–µ–∂–¥—É –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º–∏ –∏ —Å–∏–º–ø—Ç–æ–º–∞–º–∏"""
        print("  üè• –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω—ã—Ö –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π...")
        associations = {}
        
        # –°–æ–∑–¥–∞–µ–º —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏
        for category, diseases in self.diseases_database.items():
            primary_symptoms = self.symptoms_database.get(category, [])
            
            for disease in diseases:
                # –û—Å–Ω–æ–≤–Ω—ã–µ —Å–∏–º–ø—Ç–æ–º—ã –∏–∑ —Ç–æ–π –∂–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (70-90% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)
                main_symptoms = []
                if primary_symptoms:
                    main_count = random.randint(3, min(7, len(primary_symptoms)))
                    main_symptoms = random.sample(primary_symptoms, main_count)
                
                # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–∏–º–ø—Ç–æ–º—ã –∏–∑ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π (20-40% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)
                additional_symptoms = []
                for other_category in self.symptoms_database:
                    if other_category != category and random.random() < 0.35:
                        other_symptoms = self.symptoms_database[other_category]
                        if other_symptoms:
                            add_count = random.randint(1, min(3, len(other_symptoms)))
                            additional_symptoms.extend(
                                random.sample(other_symptoms, add_count)
                            )
                
                # –û–±—ä–µ–¥–∏–Ω—è–µ–º –≤—Å–µ —Å–∏–º–ø—Ç–æ–º—ã –¥–ª—è —ç—Ç–æ–≥–æ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è
                all_symptoms = list(set(main_symptoms + additional_symptoms))
                
                # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–ø—Ç–æ–º–æ–≤
                if len(all_symptoms) > 10:
                    all_symptoms = random.sample(all_symptoms, 10)
                
                associations[disease] = all_symptoms
        
        total_associations = sum(len(symptoms) for symptoms in associations.values())
        print(f"  ‚úÖ –°–æ–∑–¥–∞–Ω–æ {len(associations)} –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π —Å {total_associations} —Å–∏–º–ø—Ç–æ–º–Ω—ã–º–∏ —Å–≤—è–∑—è–º–∏")
        return associations
    
    def generate_comorbidity_patterns(self) -> Dict[str, List[str]]:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –ü–û–õ–ù–´–ï –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π"""
        print("  üîó –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π...")
        comorbidity_patterns = {}
        
        # –°–æ–∑–¥–∞–µ–º —Ä–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π
        for category, diseases in self.diseases_database.items():
            for disease in diseases:
                comorbidities = []
                
                # –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –∏–∑ —Ç–æ–π –∂–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (30% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)
                if random.random() < 0.3:
                    same_category_diseases = [d for d in diseases if d != disease]
                    if same_category_diseases:
                        comorbidities.extend(
                            random.sample(same_category_diseases, 
                                        min(1, len(same_category_diseases)))
                        )
                
                # –î–æ–±–∞–≤–ª—è–µ–º –∏–∑ –¥—Ä—É–≥–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π (20% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å)
                if random.random() < 0.2:
                    other_categories = [cat for cat in self.diseases_database if cat != category]
                    if other_categories:
                        other_category = random.choice(other_categories)
                        other_diseases = self.diseases_database[other_category]
                        if other_diseases:
                            comorbidities.extend(
                                random.sample(other_diseases, 
                                            min(1, len(other_diseases)))
                            )
                
                if comorbidities:
                    comorbidity_patterns[disease] = comorbidities
        
        total_comorbidities = sum(len(comorbids) for comorbids in comorbidity_patterns.values())
        print(f"  ‚úÖ –°–æ–∑–¥–∞–Ω–æ {len(comorbidity_patterns)} –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Å {total_comorbidities} —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è–º–∏")
        return comorbidity_patterns
    
    def generate_single_medical_record(self, associations: Dict[str, List[str]], 
                                     comorbidities: Dict[str, List[str]]) -> Dict:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–µ–¥–∏—Ü–∏–Ω—Å–∫—É—é –∑–∞–ø–∏—Å—å —Å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–º —Ä–∞–∑–Ω–æ–æ–±—Ä–∞–∑–∏–µ–º"""
        
        max_attempts = 20  # –£–º–µ–Ω—å—à–∏–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ø—ã—Ç–æ–∫ –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏
        
        for attempt in range(max_attempts):
            # –í—ã–±–∏—Ä–∞–µ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—é –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è
            categories = list(self.diseases_database.keys())
            category = random.choice(categories)
            
            # –í—ã–±–∏—Ä–∞–µ–º —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º–æ–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ
            rare_diseases = self.get_rare_diseases(category)
            disease = rare_diseases[0] if rare_diseases else random.choice(self.diseases_database[category])
            
            # –ë—ã—Å—Ç—Ä—ã–π –≤—ã–±–æ—Ä —Ç—è–∂–µ—Å—Ç–∏
            severity = random.choice(['very_low', 'low', 'medium', 'high', 'very_high'])
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∏–º–ø—Ç–æ–º–æ–≤
            if severity in ['very_low', 'low']:
                symptoms_count = random.randint(2, 3)
            elif severity == 'medium':
                symptoms_count = random.randint(3, 5)
            else:
                symptoms_count = random.randint(5, 7)
            
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—É—é –∫–æ–º–±–∏–Ω–∞—Ü–∏—é —Å–∏–º–ø—Ç–æ–º–æ–≤
            symptoms = self.generate_unique_symptoms_combination(disease, category, symptoms_count)
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –≤—Å–µ–π –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏
            if self.is_unique_combination(disease, symptoms):
                # –û—Ç–º–µ—á–∞–µ–º –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—É—é
                self.mark_as_used(disease, symptoms)
                
                # –ë—ã—Å—Ç—Ä—ã–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
                age = random.randint(18, 80)
                if age < 25:
                    age_group = 'young_adults'
                elif age < 60:
                    age_group = 'adults'
                else:
                    age_group = 'elderly'
                
                gender = random.choice(['male', 'female'])
                
                # –ü–æ–ª–Ω—ã–µ —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
                comorbid_diseases = []
                if disease in comorbidities and random.random() < 0.25:  # 25% –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å
                    available_comorbidities = comorbidities[disease]
                    if available_comorbidities:
                        comorbid_count = random.randint(1, min(2, len(available_comorbidities)))
                        comorbid_diseases = random.sample(available_comorbidities, comorbid_count)
                
                # –°–æ–∑–¥–∞–µ–º –∑–∞–ø–∏—Å—å
                record = {
                    'name': disease,
                    'symptoms': symptoms,
                    'severity': severity,
                    'category': category,
                    'age': age,
                    'age_group': age_group,
                    'gender': gender,
                    'comorbidities': comorbid_diseases,
                    'symptoms_count': len(symptoms),
                    'description': f'–£–Ω–∏–∫–∞–ª—å–Ω–∞—è –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∞—è –∑–∞–ø–∏—Å—å –¥–ª—è {disease}',
                    'synthetic': True,
                    'source': 'unique_generator',
                    'uniqueness_attempt': attempt + 1
                }
                
                return record
        
        # –ï—Å–ª–∏ –Ω–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—É—é –∑–∞–ø–∏—Å—å –∑–∞ max_attempts –ø–æ–ø—ã—Ç–æ–∫
        print(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ–∑–¥–∞—Ç—å —É–Ω–∏–∫–∞–ª—å–Ω—É—é –∑–∞–ø–∏—Å—å –∑–∞ {max_attempts} –ø–æ–ø—ã—Ç–æ–∫, –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é")
        
        # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –∑–∞–ø–∏—Å—å
        category = random.choice(list(self.diseases_database.keys()))
        disease = random.choice(self.diseases_database[category])
        symptoms = random.sample(self.symptoms_database.get(category, []), 
                               min(3, len(self.symptoms_database.get(category, []))))
        
        return {
            'name': disease,
            'symptoms': symptoms,
            'severity': 'medium',
            'category': category,
            'age': random.randint(18, 80),
            'age_group': 'adults',
            'gender': random.choice(['male', 'female']),
            'comorbidities': [],
            'symptoms_count': len(symptoms),
            'description': f'–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –¥–ª—è {disease}',
            'synthetic': True,
            'source': 'fallback_generator'
        }
    
    def generate_massive_dataset(self, total_records: int = 100000) -> List[Dict]:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–∞—Å—Å–∏–≤–Ω—ã–π –Ω–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö"""
        print(f"üöÄ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è {total_records:,} –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –∑–∞–ø–∏—Å–µ–π...")
        
        # –°–æ–∑–¥–∞–µ–º –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏
        print("üìù –°–æ–∑–¥–∞–Ω–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–π –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–µ-—Å–∏–º–ø—Ç–æ–º...")
        associations = self.generate_disease_symptom_associations()
        
        print("üîó –°–æ–∑–¥–∞–Ω–∏–µ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ —Å–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π...")
        comorbidities = self.generate_comorbidity_patterns()
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ
        dataset = []
        start_time = time.time()
        
        print(f"\n‚ö° –ù–∞—á–∏–Ω–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö...")
        
        for i in range(total_records):
            try:
                record = self.generate_single_medical_record(associations, comorbidities)
                dataset.append(record)
                
                # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥—ã–µ 100 –∑–∞–ø–∏—Å–µ–π
                if (i + 1) % 100 == 0 or i == total_records - 1:
                    self.show_progress(i + 1, total_records, start_time, "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è")
                
            except Exception as e:
                logger.warning(f"–û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏ {i+1}: {e}")
                continue
        
        print(f"\n‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞! –°–æ–∑–¥–∞–Ω–æ {len(dataset):,} –∑–∞–ø–∏—Å–µ–π")
        elapsed = time.time() - start_time
        print(f"‚è±Ô∏è –í—Ä–µ–º—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: {int(elapsed//60)}–º {int(elapsed%60)}—Å")
        print(f"üöÄ –°–∫–æ—Ä–æ—Å—Ç—å: {len(dataset)/elapsed:.1f} –∑–∞–ø–∏—Å–µ–π/—Å–µ–∫")
        
        return dataset
    
    def add_noise_and_variations(self, dataset: List[Dict]) -> List[Dict]:
        """–î–æ–±–∞–≤–ª—è–µ—Ç —à—É–º –∏ –≤–∞—Ä–∏–∞—Ü–∏–∏ –≤ –¥–∞–Ω–Ω—ã–µ"""
        print(f"\nüîÑ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —à—É–º–∞ –∏ –≤–∞—Ä–∏–∞—Ü–∏–π –∫ {len(dataset):,} –∑–∞–ø–∏—Å—è–º...")
        
        noisy_dataset = []
        start_time = time.time()
        
        for i, record in enumerate(dataset):
            # –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–ø–∏—Å—å
            noisy_dataset.append(record)
            
            # –°–æ–∑–¥–∞–µ–º –≤–∞—Ä–∏–∞—Ü–∏–∏ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 10%
            if random.random() < 0.1:
                variation = record.copy()
                
                # –î–æ–±–∞–≤–ª—è–µ–º/—É–±–∏—Ä–∞–µ–º —Å–∏–º–ø—Ç–æ–º—ã
                if random.random() < 0.5:
                    # –î–æ–±–∞–≤–ª—è–µ–º —Å–∏–º–ø—Ç–æ–º
                    category = variation['category']
                    available_symptoms = self.symptoms_database.get(category, [])
                    new_symptoms = [s for s in available_symptoms if s not in variation['symptoms']]
                    if new_symptoms:
                        variation['symptoms'].append(random.choice(new_symptoms))
                else:
                    # –£–±–∏—Ä–∞–µ–º —Å–∏–º–ø—Ç–æ–º
                    if len(variation['symptoms']) > 2:
                        variation['symptoms'].pop(random.randint(0, len(variation['symptoms'])-1))
                
                # –ò–∑–º–µ–Ω—è–µ–º —Ç—è–∂–µ—Å—Ç—å
                if random.random() < 0.3:
                    severities = list(self.severity_levels.keys())
                    current_idx = severities.index(variation['severity'])
                    if current_idx > 0 and random.random() < 0.5:
                        variation['severity'] = severities[current_idx - 1]
                    elif current_idx < len(severities) - 1:
                        variation['severity'] = severities[current_idx + 1]
                
                variation['symptoms_count'] = len(variation['symptoms'])
                noisy_dataset.append(variation)
            
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥—ã–µ 1000 –∑–∞–ø–∏—Å–µ–π
            if (i + 1) % 1000 == 0 or i == len(dataset) - 1:
                self.show_progress(i + 1, len(dataset), start_time, "–í–∞—Ä–∏–∞—Ü–∏–∏")
        
        print(f"\n‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ {len(noisy_dataset) - len(dataset):,} –≤–∞—Ä–∏–∞—Ü–∏–π")
        return noisy_dataset
    
    def save_massive_dataset(self, dataset: List[Dict], filename: str = "massive_medical_data") -> Dict[str, Any]:
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–∞—Å—Å–∏–≤–Ω–æ–≥–æ –Ω–∞–±–æ—Ä–∞ –¥–∞–Ω–Ω—ã—Ö"""
        start_time = time.time()
        timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
        
        # JSON —Ñ–∞–π–ª
        print("üìÑ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ JSON —Ñ–∞–π–ª–∞...")
        json_path = os.path.join(self.output_dir, f"{filename}_{timestamp}.json")
        with open(json_path, 'w', encoding='utf-8') as f:
            json.dump(dataset, f, ensure_ascii=False, indent=2)
        
        # CSV —Ñ–∞–π–ª
        print("üìä –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ CSV —Ñ–∞–π–ª–∞...")
        csv_path = os.path.join(self.output_dir, f"{filename}_{timestamp}.csv")
        fieldnames = ['name', 'symptoms', 'severity', 'category', 'age', 'age_group', 
                     'gender', 'comorbidities', 'symptoms_count', 'description', 'synthetic', 'source', 'uniqueness_attempt']
        
        with open(csv_path, 'w', newline='', encoding='utf-8') as f:
            writer = csv.DictWriter(f, fieldnames=fieldnames)
            writer.writeheader()
            
            for i, record in enumerate(dataset):
                csv_row = record.copy()
                csv_row['symptoms'] = '; '.join(csv_row['symptoms'])
                csv_row['comorbidities'] = '; '.join(csv_row['comorbidities'])
                writer.writerow(csv_row)
                
                # –ü—Ä–æ–≥—Ä–µ—Å—Å –∫–∞–∂–¥—ã–µ 5000 –∑–∞–ø–∏—Å–µ–π
                if (i + 1) % 5000 == 0 or i == len(dataset) - 1:
                    self.show_progress(i + 1, len(dataset), start_time, "–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ")
        
        # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
        print(f"\nüìà –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏...")
        stats = self.calculate_comprehensive_stats(dataset)
        stats_path = os.path.join(self.output_dir, f"{filename}_stats_{timestamp}.json")
        with open(stats_path, 'w', encoding='utf-8') as f:
            json.dump(stats, f, ensure_ascii=False, indent=2)
        
        elapsed = time.time() - start_time
        print(f"\n‚úÖ –§–∞–π–ª—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –∑–∞ {elapsed:.1f}—Å:")
        print(f"  üìÑ JSON: {json_path}")
        print(f"  üìä CSV: {csv_path}")
        print(f"  üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: {stats_path}")
        
        return {
            'json': json_path,
            'csv': csv_path,
            'stats': stats_path,
            'total_records': len(dataset)
        }
    
    def calculate_comprehensive_stats(self, dataset: List[Dict]) -> Dict[str, Any]:
        """–†–∞—Å—á–µ—Ç –ø–æ–¥—Ä–æ–±–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏"""
        stats = {
            'total_records': len(dataset),
            'timestamp': datetime.now().isoformat(),
            'categories': {},
            'severity_distribution': {},
            'age_distribution': {},
            'gender_distribution': {},
            'symptoms_stats': {},
            'comorbidities_stats': {},
            'unique_diseases': set(),
            'unique_symptoms': set()
        }
        
        for record in dataset:
            # –ö–∞—Ç–µ–≥–æ—Ä–∏–∏
            category = record.get('category', 'unknown')
            stats['categories'][category] = stats['categories'].get(category, 0) + 1
            
            # –¢—è–∂–µ—Å—Ç—å
            severity = record.get('severity', 'unknown')
            stats['severity_distribution'][severity] = stats['severity_distribution'].get(severity, 0) + 1
            
            # –í–æ–∑—Ä–∞—Å—Ç
            age_group = record.get('age_group', 'unknown')
            stats['age_distribution'][age_group] = stats['age_distribution'].get(age_group, 0) + 1
            
            # –ü–æ–ª
            gender = record.get('gender', 'unknown')
            stats['gender_distribution'][gender] = stats['gender_distribution'].get(gender, 0) + 1
            
            # –°–∏–º–ø—Ç–æ–º—ã
            symptoms = record.get('symptoms', [])
            stats['unique_symptoms'].update(symptoms)
            
            # –ó–∞–±–æ–ª–µ–≤–∞–Ω–∏—è
            stats['unique_diseases'].add(record.get('name', ''))
            
            # –°–æ–ø—É—Ç—Å—Ç–≤—É—é—â–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏—è
            comorbidities = record.get('comorbidities', [])
            if comorbidities:
                for comorbidity in comorbidities:
                    stats['comorbidities_stats'][comorbidity] = stats['comorbidities_stats'].get(comorbidity, 0) + 1
        
        # –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º sets –≤ —Å–ø–∏—Å–∫–∏
        stats['unique_diseases'] = list(stats['unique_diseases'])
        stats['unique_symptoms'] = list(stats['unique_symptoms'])
        
        # –î–æ–±–∞–≤–ª—è–µ–º —Å–≤–æ–¥–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
        stats['summary'] = {
            'total_unique_diseases': len(stats['unique_diseases']),
            'total_unique_symptoms': len(stats['unique_symptoms']),
            'avg_symptoms_per_record': sum(len(r.get('symptoms', [])) for r in dataset) / len(dataset),
            'records_with_comorbidities': sum(1 for r in dataset if r.get('comorbidities'))
        }
        
        return stats

    def generate_incremental_dataset(self, records_count: int = 50000, 
                                   existing_data_file: str = None) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–Ω–æ–≤—ã–µ, –Ω–µ–ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è)"""
        
        print(f"üîÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö: {records_count:,} –∑–∞–ø–∏—Å–µ–π")
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π
        if existing_data_file and os.path.exists(existing_data_file):
            print(f"üìÇ –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ {existing_data_file}")
            try:
                with open(existing_data_file, 'r', encoding='utf-8') as f:
                    existing_data = json.load(f)
                    
                # –û—Ç–º–µ—á–∞–µ–º –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ
                for record in existing_data:
                    disease = record.get('name', '')
                    symptoms = record.get('symptoms', [])
                    if disease and symptoms:
                        self.mark_as_used(disease, symptoms)
                
                print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(existing_data):,} —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∑–∞–ø–∏—Å–µ–π")
                print(f"üìä –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π: {len(self.used_combinations):,}")
                
            except Exception as e:
                print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö: {e}")
        
        # –°–æ–∑–¥–∞–µ–º –ø–æ–ª–Ω—ã–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏
        print("üîó –°–æ–∑–¥–∞–µ–º –ø–æ–ª–Ω—ã–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –∏ —Å–∏–º–ø—Ç–æ–º–æ–≤...")
        associations = self.generate_disease_symptom_associations()
        comorbidities = self.generate_comorbidity_patterns()
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏
        print(f"‚ö° –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º {records_count:,} –Ω–æ–≤—ã—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π...")
        
        records = []
        start_time = time.time()
        failed_attempts = 0
        
        for i in range(records_count):
            try:
                record = self.generate_single_medical_record(associations, comorbidities)
                records.append(record)
                
                if (i + 1) % 5000 == 0:
                    elapsed = time.time() - start_time
                    rate = (i + 1) / elapsed
                    eta = (records_count - i - 1) / rate if rate > 0 else 0
                    eta_str = f"{eta:.0f}—Å" if eta < 60 else f"{eta/60:.1f}–º–∏–Ω"
                    
                    self.show_progress(i + 1, records_count, start_time, 
                                     f"–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö")
                    
                    unique_count = len(self.used_combinations)
                    print(f" | –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö: {unique_count:,}")
                
            except Exception as e:
                failed_attempts += 1
                if failed_attempts > 100:
                    print(f"\n‚ö†Ô∏è –°–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ ({failed_attempts}), –æ—Å—Ç–∞–Ω–æ–≤–∫–∞")
                    break
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        timestamp = int(time.time())
        filename = f"incremental_medical_{records_count//1000}k_{timestamp}.json"
        filepath = os.path.join(self.output_dir, filename)
        
        print(f"\nüíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ {len(records):,} –Ω–æ–≤—ã—Ö –∑–∞–ø–∏—Å–µ–π –≤ {filename}...")
        with open(filepath, 'w', encoding='utf-8') as f:
            json.dump(records, f, ensure_ascii=False, indent=2)
        
        elapsed = time.time() - start_time
        rate = len(records) / elapsed
        unique_count = len(self.used_combinations)
        
        print(f"\n‚úÖ –ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–æ–∑–¥–∞–Ω—ã:")
        print(f"üìÅ –§–∞–π–ª: {filename}")
        print(f"üìä –ó–∞–ø–∏—Å–µ–π: {len(records):,}")
        print(f"‚è±Ô∏è –í—Ä–µ–º—è: {elapsed:.1f}—Å")
        print(f"üöÄ –°–∫–æ—Ä–æ—Å—Ç—å: {rate:.1f} –∑–∞–ø/—Å")
        print(f"üîÑ –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π: {unique_count:,}")
        print(f"‚ö†Ô∏è –ù–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫: {failed_attempts}")
        
        return filepath
    
    def get_uniqueness_statistics(self) -> Dict:
        """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö"""
        
        total_diseases = sum(len(diseases) for diseases in self.diseases_database.values())
        total_symptoms = sum(len(symptoms) for symptoms in self.symptoms_database.values())
        
        # –¢–æ–ø –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
        top_diseases = sorted(self.disease_counters.items(), key=lambda x: x[1], reverse=True)[:10]
        
        # –¢–æ–ø —Å–∏–º–ø—Ç–æ–º–æ–≤ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
        top_symptoms = sorted(self.symptom_counters.items(), key=lambda x: x[1], reverse=True)[:10]
        
        return {
            'unique_combinations': len(self.used_combinations),
            'total_diseases_available': total_diseases,
            'total_symptoms_available': total_symptoms,
            'diseases_used': len(self.disease_counters),
            'symptoms_used': len(self.symptom_counters),
            'top_diseases': top_diseases,
            'top_symptoms': top_symptoms,
            'coverage_diseases': len(self.disease_counters) / total_diseases * 100,
            'coverage_symptoms': len(self.symptom_counters) / total_symptoms * 100
        }
    
    def generate_unique_dataset_file(self, records_count: int, filename: str, 
                                   existing_data_file: Optional[str] = None) -> str:
        """–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Ñ–∞–π–ª —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏"""
        
        print(f"üîÑ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ —Ñ–∞–π–ª–∞: {filename}")
        print(f"üìä –ó–∞–ø–∏—Å–µ–π: {records_count:,}")
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ –µ—Å–ª–∏ –µ—Å—Ç—å
        if existing_data_file and os.path.exists(existing_data_file):
            print(f"üìÇ –ó–∞–≥—Ä—É–∂–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∏–∑: {os.path.basename(existing_data_file)}")
            try:
                with open(existing_data_file, 'r', encoding='utf-8') as f:
                    existing_data = json.load(f)
                    
                # –û—Ç–º–µ—á–∞–µ–º –≤—Å–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ
                loaded_combinations = 0
                for record in existing_data:
                    disease = record.get('name', '')
                    symptoms = record.get('symptoms', [])
                    if disease and symptoms:
                        self.mark_as_used(disease, symptoms)
                        loaded_combinations += 1
                
                print(f"‚úÖ –ó–∞–≥—Ä—É–∂–µ–Ω–æ {loaded_combinations:,} –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π")
                
            except Exception as e:
                print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö: {e}")
        
        # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
        start_time = time.time()
        dataset = []
        
        # –°–æ–∑–¥–∞–µ–º –ø–æ–ª–Ω—ã–µ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –∞—Å—Å–æ—Ü–∏–∞—Ü–∏–∏
        associations = self.generate_disease_symptom_associations()
        comorbidities = self.generate_comorbidity_patterns()
        
        print(f"‚ö° –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º {records_count:,} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π...")
        
        for i in range(records_count):
            try:
                record = self.generate_single_medical_record(associations, comorbidities)
                dataset.append(record)
                
                # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
                if (i + 1) % 5000 == 0:
                    self.show_progress(i + 1, records_count, start_time, "–ì–µ–Ω–µ—Ä–∞—Ü–∏—è —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö")
                    
            except Exception as e:
                print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–∞–ø–∏—Å–∏ {i+1}: {e}")
                continue
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ —Ñ–∞–π–ª
        timestamp = int(time.time())
        full_filename = f"{filename}_{timestamp}.json"
        filepath = os.path.join(self.output_dir, full_filename)
        
        print(f"\nüíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª: {full_filename}")
        with open(filepath, 'w', encoding='utf-8') as f:
            json.dump(dataset, f, ensure_ascii=False, indent=2)
        
        # –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º CSV
        csv_filepath = filepath.replace('.json', '.csv')
        self.save_as_csv(dataset, csv_filepath)
        
        elapsed = time.time() - start_time
        print(f"‚úÖ –§–∞–π–ª —Å–æ–∑–¥–∞–Ω: {len(dataset):,} –∑–∞–ø–∏—Å–µ–π –∑–∞ {elapsed:.1f}—Å")
        
        return filepath
    
    def save_as_csv(self, dataset: List[Dict], filepath: str):
        """–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –≤ CSV —Ñ–æ—Ä–º–∞—Ç–µ"""
        try:
            fieldnames = ['name', 'symptoms', 'severity', 'category', 'age', 'age_group', 
                         'gender', 'comorbidities', 'symptoms_count', 'description', 'synthetic', 'source']
            
            with open(filepath, 'w', newline='', encoding='utf-8') as f:
                writer = csv.DictWriter(f, fieldnames=fieldnames)
                writer.writeheader()
                
                for record in dataset:
                    csv_row = record.copy()
                    csv_row['symptoms'] = '; '.join(csv_row['symptoms'])
                    csv_row['comorbidities'] = '; '.join(csv_row['comorbidities'])
                    # –£–±–∏—Ä–∞–µ–º –ø–æ–ª–µ –∫–æ—Ç–æ—Ä–æ–≥–æ –Ω–µ—Ç –≤ fieldnames
                    csv_row.pop('uniqueness_attempt', None)
                    writer.writerow(csv_row)
                    
        except Exception as e:
            print(f"‚ö†Ô∏è –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è CSV: {e}")
    
    def verify_files_uniqueness(self, file_paths: List[str]):
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏"""
        
        print("üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏...")
        
        all_combinations = set()
        duplicate_count = 0
        
        for file_path in file_paths:
            if not os.path.exists(file_path):
                print(f"‚ö†Ô∏è –§–∞–π–ª –Ω–µ –Ω–∞–π–¥–µ–Ω: {file_path}")
                continue
                
            try:
                with open(file_path, 'r', encoding='utf-8') as f:
                    data = json.load(f)
                
                filename = os.path.basename(file_path)
                file_combinations = set()
                
                for record in data:
                    disease = record.get('name', '')
                    symptoms = record.get('symptoms', [])
                    
                    if disease and symptoms:
                        combination = self.create_unique_signature(disease, symptoms)
                        
                        if combination in all_combinations:
                            duplicate_count += 1
                        else:
                            all_combinations.add(combination)
                            file_combinations.add(combination)
                
                print(f"üìÅ {filename}: {len(file_combinations):,} —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π")
                
            except Exception as e:
                print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ–∞–π–ª–∞ {file_path}: {e}")
        
        print(f"\nüìä –ò—Ç–æ–≥–æ–≤–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"üî¢ –í—Å–µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π: {len(all_combinations):,}")
        print(f"‚ö†Ô∏è –î—É–±–ª–∏–∫–∞—Ç–æ–≤ –Ω–∞–π–¥–µ–Ω–æ: {duplicate_count}")
        
        if duplicate_count == 0:
            print("‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã —Å–æ–¥–µ—Ä–∂–∞—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ!")
        else:
            print(f"‚ùå –ù–∞–π–¥–µ–Ω—ã –¥—É–±–ª–∏–∫–∞—Ç—ã: {duplicate_count}")
        
        return duplicate_count == 0


class MedicalDataDownloader:
    """–ö–ª–∞—Å—Å –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö - –æ–±–µ—Ä—Ç–∫–∞ –¥–ª—è MassiveMedicalDataGenerator"""
    
    def __init__(self, output_dir: str = "medical_data"):
        self.generator = MassiveMedicalDataGenerator(output_dir)
        self.output_dir = output_dir
        
    def download_all_data(self, include_synthetic: bool = True, synthetic_count: int = 200) -> str:
        """–ó–∞–≥—Ä—É–∂–∞–µ—Ç/–≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ"""
        try:
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –¥–∞–Ω–Ω—ã–µ –∏—Å–ø–æ–ª—å–∑—É—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –≥–µ–Ω–µ—Ä–∞—Ç–æ—Ä
            dataset_size = synthetic_count if include_synthetic else 1000
            
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –º–µ—Ç–æ–¥ –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö
            dataset_file = self.generator.generate_unique_dataset_file(
                records_count=dataset_size,
                filename=f"medical_training_data_{dataset_size}",
                existing_data_file=None
            )
            
            logger.info(f"–ú–µ–¥–∏—Ü–∏–Ω—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã: {dataset_file}")
            return dataset_file
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö: {e}")
            raise e


def main():
    """–û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –£–ù–ò–ö–ê–õ–¨–ù–´–• —Ñ–∞–π–ª–æ–≤ –¥–∞–Ω–Ω—ã—Ö"""
    generator = MassiveMedicalDataGenerator()
    
    # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ú–ò–õ–õ–ò–û–ù–´ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–µ—Ä—å–µ–∑–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è
    datasets_to_generate = [
        {'size': 100000, 'name': 'medical_100k'},
        {'size': 500000, 'name': 'medical_500k'},
        {'size': 1000000, 'name': 'medical_1M'},
        {'size': 2000000, 'name': 'medical_2M'},
        {'size': 5000000, 'name': 'medical_5M'}
    ]
    
    print("üè• –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –£–ù–ò–ö–ê–õ–¨–ù–´–• –º–µ–¥–∏—Ü–∏–Ω—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö")
    print("üìã –ö–∞–∂–¥—ã–π —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ç–æ–ª—å–∫–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–∞–ø–∏—Å–∏")
    print("üîÑ –î–∞–Ω–Ω—ã–µ –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏ –ù–ï –ø–æ–≤—Ç–æ—Ä—è—é—Ç—Å—è")
    print("=" * 60)
    
    total_start_time = time.time()
    generated_files = []
    
    for i, dataset_config in enumerate(datasets_to_generate):
        print(f"\nüìä –î–∞—Ç–∞—Å–µ—Ç {i+1}/{len(datasets_to_generate)}: {dataset_config['name']}")
        print("-" * 40)
        
        dataset_start_time = time.time()
        
        try:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ñ–∞–π–ª—ã –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
            existing_file = None
            if i > 0 and generated_files:
                existing_file = generated_files[-1]  # –ë–µ—Ä–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ñ–∞–π–ª
                print(f"üìÇ –ó–∞–≥—Ä—É–∂–∞–µ–º —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ —Ñ–∞–π–ª–∞: {os.path.basename(existing_file)}")
            
            # –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –£–ù–ò–ö–ê–õ–¨–ù–´–ï –¥–∞–Ω–Ω—ã–µ
            dataset_file = generator.generate_unique_dataset_file(
                records_count=dataset_config['size'],
                filename=dataset_config['name'],
                existing_data_file=existing_file
            )
            
            generated_files.append(dataset_file)
            
            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –¥–∞—Ç–∞—Å–µ—Ç—É
            dataset_elapsed = time.time() - dataset_start_time
            print(f"\n‚úÖ –î–∞—Ç–∞—Å–µ—Ç {dataset_config['name']} –≥–æ—Ç–æ–≤!")
            print(f"üìÅ –§–∞–π–ª: {os.path.basename(dataset_file)}")
            print(f"‚è±Ô∏è –í—Ä–µ–º—è: {int(dataset_elapsed//60)}–º {int(dataset_elapsed%60)}—Å")
            
            # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏
            unique_stats = generator.get_uniqueness_statistics()
            print(f"üî¢ –£–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –∫–æ–º–±–∏–Ω–∞—Ü–∏–π: {unique_stats['unique_combinations']:,}")
            print(f"üìä –ü–æ–∫—Ä—ã—Ç–∏–µ –∑–∞–±–æ–ª–µ–≤–∞–Ω–∏–π: {unique_stats['coverage_diseases']:.1f}%")
            print(f"üéØ –ü–æ–∫—Ä—ã—Ç–∏–µ —Å–∏–º–ø—Ç–æ–º–æ–≤: {unique_stats['coverage_symptoms']:.1f}%")
            
        except Exception as e:
            print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ {dataset_config['name']}: {e}")
            continue
    
    total_elapsed = time.time() - total_start_time
    print(f"\nüéâ –í—Å—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!")
    print(f"‚è±Ô∏è –û–±—â–µ–µ –≤—Ä–µ–º—è: {int(total_elapsed//60)}–º {int(total_elapsed%60)}—Å")
    print(f"üìÅ –°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤: {len(generated_files)}")
    
    # –§–∏–Ω–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
    if generated_files:
        print(f"\nüìã –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:")
        for file_path in generated_files:
            filename = os.path.basename(file_path)
            print(f"   ‚Ä¢ {filename}")
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏
        print(f"\nüîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ñ–∞–π–ª–∞–º–∏...")
        generator.verify_files_uniqueness(generated_files)

if __name__ == "__main__":
    main() 